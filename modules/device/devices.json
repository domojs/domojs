[{"name":"vsx","type":"pioneer","category":"switch"},{"name":"freebox","type":"freebox","category":"switch","code":"7738026","fbxName":"hd1"},{"name":"pc","type":"wake on lan","category":"switch","mac":"00-1d-92-6b-a8-1c"},{"name":"Volets","type":"complexVirtual","category":"switch","script":"var selector=4;\r\n\r\nvar up=18;\r\nvar down=17;\r\nvar stop=21;\r\n\r\nfunction changeChannel(newChannel, callback){\r\n    if(newChannel==state.currentChannel)\r\n        callback();\r\n    else\r\n        $.ajax({type:'get', url:'/api/gpio/press/'+selector+'?repeat='+((newChannel-(state.currentChannel || 0)+5)%5), success:function(){\r\n            state.currentChannel=newChannel;\r\n            callback();\r\n        }});\r\n}\r\n\r\n\r\ndevice.commands={};\r\n$.each([1,2,3,4,5], function(i){\r\n    device.commands['up'+(i+1)]=function(callback){\r\n        changeChannel(i, function(){\r\n            $.ajax({type:'get', url:'/api/gpio/press/'+up, success:callback, error:callback});\r\n        });\r\n    };\r\n    device.commands['down'+(i+1)]=function(callback){\r\n        changeChannel(i, function(){\r\n            $.ajax({type:'get', url:'/api/gpio/press/'+down, success:callback, error:callback});\r\n        });\r\n    };\r\n    device.commands['halt'+(i+1)]=function(callback){\r\n        changeChannel(i, function(){\r\n            $.ajax({type:'get', url:'/api/gpio/press/'+stop, success:callback, error:callback});\r\n        });\r\n    };\r\n}); "}]